<script>
    $('.edit-lesson-button').click(function() {
      var lessonUrl = $(event.target).data('lesson-url');
      $('#editLessonForm').attr('action', lessonUrl);
    });
  });
</script>

<br />

<div class="booyah-box col-xs-10 col-xs-offset-1">
  <h1><%= current_lesson.title %></h1>
  <p>
    <%= current_lesson.subtitle %>
  </p>

  <br class="clr">

  <% if current_lesson.video.present? %>
  <br/>
  <video class="video-js vjs-default-skin vjs-big-play-centered vjs-fluid" controls
      preload="auto" poster="/assets/black.jpg" data-setup="{}">
        <source src="<%= current_lesson.video.to_s %>" type='video/mp4'>
          <noscript>
              <p class="vjs-no-js">
                To view this video please enable JavaScript, and consider upgrading to a web browser that
                <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
              </p>
          </noscript>
  </video>
  <% end %>


    <br class="clr">

  <div class="videoWrapper">
    <% if current_lesson.embed.present? %>
      <br/>
        <iframe width="560" height="349" frameborder="0" allowfullscreen src="<%= "http://www.youtube.com/embed/"+current_lesson.code %>">
        </iframe>
    <% end %>
  </div>

    <br class="clr">
    <br/>

<% if current_lesson.next_lesson.present? %>
  <%= link_to lesson_path(current_lesson.next_lesson), class: 'btn btn-default pull-right' do %>
    Next Lesson &nbsp;
    <span class="glyphicon glyphicon-forward"></span>
  <% end %>
<% end %>

    <br class="clr">


    <!-- Edit Lesson -->

    <% if current_user && current_user == current_lesson.user %>
      <button class="pull right button-pill edit-lesson-button" data-toggle="modal" data-target="editLessonModal" data-lesson-url="<%= instructor_lesson_path(section) %>">
        Edit Lesson
      <button>
    <% end %>

<br/>
</div>

<!-- Lesson Edit Modal -->

<div class="modal fade" id="editLessonModal" tabindex="-1" role="dialog" aria-labelledby="editLessonModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="editLessonModalLabel">Edit lesson</h4>
      </div>

      <%= simple_form_for @lesson, url: "#", html: {id: 'editLessonForm' }, method: :post do |f| %>
        <div class="modal-body">
            <%= f.input :title %>
            <%= f.input :subtitle %>
            <%= f.input :video %><br/>
            <%= f.input :embed, label: 'Copy YouTube Link to Embed Video: ' %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <%= f.submit "Submit", class: 'btn btn-primary' %>
        </div>
      <% end%>
    </div>
  </div>
</div>
